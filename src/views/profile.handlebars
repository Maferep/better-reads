
  <div id="navbar">
    <div id="logo"><a href="/">Better Reads</a></div>
    <div class="user-actions">
      {{#if loggedIn}}
      <a href="/logout">Logout</a>
      <a href="/profile">Hello, {{username}}</a>
      {{else}}
      <a href="/login">Login</a>
      <a href="/register">Register</a>
      {{/if}}
    </div>
  </div>

    <div class="profile-container">
        <h1>Username: {{username}}</h1>
        
        {{#if isProfileComplete}}   
            <img src="static/{{profile_photo}}" alt="Profile Photo">
            <div class="bio">
                <p>{{bio}}</p>
            </div>
        {{else}}   
            <form action="/profile" method="POST" enctype="multipart/form-data">
                <label for="bio">Bio:</label>
                <textarea name="bio">{{bio}}</textarea>

                <label for="profile_photo">Upload Profile Photo:</label>
                <input type="file" name="profile_photo" accept="image/*" />

                <button type="submit">Update Profile</button>
            </form>
        {{/if}}
        <div>
        <h2>Followers: {{followers.length}}</h2>
        <h2>Following: {{following.length}}</h2>
    </div>
    </div>
     {{#unless isOwnProfile}}
    <button id="follow-button" onclick="toggleFollow({{userId}})">
      {{#if isFollowing}}Unfollow{{else}}Follow{{/if}}
    </button>
  {{/unless}}
    <div>
        <h2 style="text-align: center;">My Posts</h2>
        <div class="my-posts">
            {{#each posts}}
            <div id="new-post">
                <p>book id: {{this.book_id}}</p>
                <p>content: {{this.text_content}}</p>
                <p>date: {{this.date}}</p>
                <p>Likes: {{this.likes}}</p>
            </div>
            {{/each}}
        </div>
    </div>

<script>
  let isFollowing = {{isFollowing}}; 
  async function toggleFollow(userId) {
    const button = document.getElementById('follow-button');
    const url = isFollowing ? `/unfollow/${userId}` : `/follow/${userId}`; 

    try {
     const response = await fetch(url, {
        method: 'POST',
        headers: {
        'Content-Type': 'application/json'
     }
     });

     if (response.ok) {
       
       button.innerText = isFollowing ? 'Follow' : 'Unfollow';
       isFollowing = !isFollowing; 
      } else {
       const errorData = await response.json();
       alert(`Error: ${errorData.error}`);
      }
     } catch (error) {
      alert(`Request failed: ${error.message}`);
     }
}
</script>

